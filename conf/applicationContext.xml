<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN"
        "http://www.springframework.org/dtd/spring-beans.dtd">

<beans>
    <bean id="dataSource"
          class="org.springframework.jdbc.datasource.DriverManagerDataSource">
        <property name="driverClassName" value="com.mysql.jdbc.Driver"/>
        <property name="url" value="jdbc:mysql://localhost/swing_quilt"/>
        <property name="username" value="root"/>
        <property name="password" value=""/>
    </bean>

    <bean id="factory"
          class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">
        <property name="dataSource">
            <ref local="dataSource"/>
        </property>
        <property name="annotatedClasses">
            <list>
                <value>com.beckproduct.quilt.domain.Quilt</value>
                <value>com.beckproduct.quilt.domain.QuiltTile</value>
            </list>
        </property>
        <property name="hibernateProperties">
            <props>
                <prop key="hibernate.dialect">
                    org.hibernate.dialect.MySQL5Dialect
                </prop>
                <prop key="hibernate.hbm2ddl.auto">update</prop>
            </props>
        </property>
    </bean>

    <bean id="transactionManager"
          class="org.springframework.orm.hibernate3.HibernateTransactionManager">
        <property name="sessionFactory">
            <ref local="factory"/>
        </property>
    </bean>

    <bean id="txProxyPersistenceTemplate" abstract="true"
          class="org.springframework.transaction.interceptor.TransactionProxyFactoryBean">
        <property name="transactionManager">
            <ref local="transactionManager"/>
        </property>
        <property name="transactionAttributes">
            <props>
                <prop key="*">PROPAGATION_REQUIRES_NEW</prop>
            </props>
        </property>
    </bean>

    <bean id="mainFrame"
          class="com.beckproduct.quilt.frame.MainFrame">
        <constructor-arg value="Sarah's quilt generator!" />
        <constructor-arg value="mainFrame" />
        <property name="mainMenuBar">
            <ref local="mainMenuBar" />
        </property>
    </bean>

    <bean id="mainMenuBar"
          class="com.beckproduct.quilt.menu.MainMenuBar" >
        <property name="fileMenu">
            <ref local="fileMenu" />
        </property>
    </bean>

    <bean id="fileMenu" init-method="init"
          class="com.beckproduct.quilt.menu.FileMenu" >
        <property name="newMenuItem">
            <ref local="newMenuItem" />
        </property>
        <property name="openMenuItem">
            <ref local="openMenuItem" />
        </property>
        <property name="saveMenuItem">
            <ref local="saveMenuItem" />
        </property>
        <property name="saveAsMenuItem">
            <ref local="saveAsMenuItem" />
        </property>
        <property name="printMenuItem">
            <ref local="printMenuItem" />
        </property>
    </bean>

    <bean id="newMenuItem" init-method="init"
          class="com.beckproduct.quilt.menu.item.NewMeuItem">
        <property name="actionListener">
            <ref local="newListener"/>
        </property>
    </bean>

    <bean id="openMenuItem" init-method="init"
          class="com.beckproduct.quilt.menu.item.OpenMeuItem">
        <property name="actionListener">
            <ref local="openListener"/>
        </property>
    </bean>

    <bean id="saveMenuItem" init-method="init"
          class="com.beckproduct.quilt.menu.item.SaveMeuItem">
        <property name="actionListener">
            <ref local="saveListener"/>
        </property>
    </bean>

    <bean id="saveAsMenuItem" init-method="init"
          class="com.beckproduct.quilt.menu.item.SaveAsMeuItem">
        <property name="actionListener">
            <ref local="saveAsListener"/>
        </property>
    </bean>

    <bean id="printMenuItem" init-method="init"
          class="com.beckproduct.quilt.menu.item.PrintMeuItem">
        <property name="actionListener">
            <ref local="printListener"/>
        </property>
    </bean>

    <bean id="newListener"
          class="com.beckproduct.quilt.listener.NewListener">
        <property name="frame">
            <ref local="newQuiltFrame" />
        </property>
    </bean>

    <bean id="createListener"
          class="com.beckproduct.quilt.listener.CreateListener">
        <property name="quiltRepository">
            <ref local="quiltRepository"/>
        </property>
    </bean>

    <bean id="openListener"
          class="com.beckproduct.quilt.listener.OpenListener">
        <property name="quiltRepository">
            <ref local="quiltRepository"/>
        </property>
    </bean>

    <bean id="saveListener"
          class="com.beckproduct.quilt.listener.SaveListener">
        <constructor-arg ref="mainFrame" />
        <property name="quiltRepository">
            <ref local="quiltRepository"/>
        </property>
    </bean>

    <bean id="saveAsListener"
          class="com.beckproduct.quilt.listener.SaveAsListener">
        <property name="quiltRepository">
            <ref local="quiltRepository"/>
        </property>
    </bean>

    <bean id="printListener"
          class="com.beckproduct.quilt.listener.PrintListener">
    </bean>

    <bean id="newQuiltFrame"
          class="com.beckproduct.quilt.frame.NewFrame">
        <constructor-arg ref="createListener" />
    </bean>

    <bean id="quiltRepositoryTarget"
          class="com.beckproduct.quilt.repository.QuiltRepository">
        <property name="sessionFactory">
            <ref local="factory"/>
        </property>
    </bean>

    <bean id="quiltRepository" parent="txProxyPersistenceTemplate">
        <property name="target">
            <ref local="quiltRepositoryTarget"/>
        </property>
    </bean>
</beans>